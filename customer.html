<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <title>RJVC Customer Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    *{
      box-sizing:border-box;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
    }
    body{
      margin:0;
      background:#f3f4f6;
      color:#111827;
    }
    h1,h2,h3{
      margin:0 0 10px;
    }
    .page{
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:16px;
    }
    .card{
      background:#fff;
      border-radius:18px;
      box-shadow:0 12px 30px rgba(15,23,42,.18);
      padding:22px;
      max-width:650px;
      width:100%;
    }
    label{
      display:block;
      font-size:14px;
      margin-bottom:4px;
    }
    input,textarea{
      width:100%;
      padding:10px 12px;
      border-radius:10px;
      border:1px solid #d1d5db;
      font-size:15px;
      outline:none;
      resize:vertical;
    }
    input:focus,textarea:focus{
      border-color:#2563eb;
      box-shadow:0 0 0 2px rgba(37,99,235,.25);
    }
    .btn{
      border:none;
      border-radius:999px;
      padding:10px 18px;
      font-size:15px;
      font-weight:600;
      cursor:pointer;
    }
    .btn-primary{
      background:#1d4ed8;
      color:#fff;
    }
    .btn-outline{
      background:#fff;
      border:1px solid #d1d5db;
      color:#111827;
    }
    .btn-sm{
      padding:6px 12px;
      font-size:13px;
    }
    .mt-1{margin-top:4px;}
    .mt-2{margin-top:8px;}
    .mt-3{margin-top:12px;}
    .mt-4{margin-top:16px;}
    .flex{display:flex;align-items:center;}
    .between{justify-content:space-between;}
    .wrap-row{display:flex;gap:10px;flex-wrap:wrap;}
    .small{font-size:12px;color:#6b7280;}
    .error{color:#b91c1c;font-size:13px;margin-top:6px;}
    .ok{color:#166534;font-size:13px;margin-top:6px;}

    .wallet{
      border-radius:16px;
      padding:14px;
      color:#fff;
      margin-top:10px;
    }
    .wallet-comm{
      background:#020617;
    }
    .wallet-bonus{
      background:#14532d;
    }
    .wallet-label{
      font-size:13px;
      opacity:.9;
    }
    .wallet-amount{
      font-size:26px;
      font-weight:700;
    }

    .section-title{
      font-size:15px;
      font-weight:600;
      margin-bottom:4px;
    }
    table{
      width:100%;
      border-collapse:collapse;
      font-size:13px;
    }
    th,td{
      padding:6px 4px;
      border-bottom:1px solid #e5e7eb;
      text-align:left;
    }
    th{
      font-size:11px;
      text-transform:uppercase;
      color:#6b7280;
    }
  </style>
</head>
<body>
<!-- RJVC INTRO SECTION (Top Banner) -->
<div style="background:#ffffff;padding:18px;border-bottom:1px solid #e5e7eb;">
  <h2 style="margin:0 0 10px;font-size:20px;font-weight:700;">
    ‚≠ê ‡§è‡§Ü‡§à ‡§ï‡§æ ‡§ú‡§º‡§Æ‡§æ‡§®‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à‚Ä¶ ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡§Æ‡§æ‡§à ‡§∞‡•Å‡§ï‡§®‡•Ä ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§ö‡§æ‡§π‡§ø‡§è?
  </h2>

  <p style="font-size:14px;color:#374151;line-height:1.6;">
    üî• <b>‡§Ö‡§ó‡§≤‡•á 1 ‡§∏‡§æ‡§≤ ‡§Æ‡•á‡§Ç ‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ ‡§µ‡•à‡§∏‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§∞‡§π‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä ‡§ú‡•à‡§∏‡•Ä ‡§Ü‡§ú ‡§π‡•à‡•§</b><br><br>
    AI (Artificial Intelligence) ‡§®‡•á ‡§™‡§ø‡§õ‡§≤‡•á 12 ‡§Æ‡§π‡•Ä‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç  
    ‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ ‡§ï‡•Ä ‡§∏‡§¨‡§∏‡•á ‡§¨‡§°‡§º‡•Ä ‡§ï‡§Ç‡§™‡§®‡§ø‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç <b>‡§≤‡§æ‡§ñ‡•ã‡§Ç ‡§≤‡•ã‡§ó‡•ã‡§Ç ‡§ï‡•Ä ‡§®‡•å‡§ï‡§∞‡§ø‡§Ø‡§æ‡§Å ‡§ñ‡§æ ‡§≤‡•Ä‡§Ç‡•§</b><br><br>

    ‚Ä¢ Google ‡§®‡•á AI automation ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§π‡§ú‡§º‡§æ‡§∞‡•ã‡§Ç ‡§≤‡•ã‡§ó‡•ã‡§Ç ‡§ï‡•ã ‡§®‡§ø‡§ï‡§æ‡§≤‡§æ<br>
    ‚Ä¢ Amazon, Meta, IBM ‡§®‡•á ‡§≠‡•Ä ‡§ï‡§∞‡•ç‡§Æ‡§ö‡§æ‡§∞‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§¨‡§¶‡§≤‡§ï‡§∞ AI ‡§ï‡•ã ‡§∞‡§ñ‡§æ<br>
    ‚Ä¢ ‡§Ü‡§®‡•á ‡§µ‡§æ‡§≤‡•á 6‚Äì12 ‡§Æ‡§π‡•Ä‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§≤‡§æ‡§ñ‡•ã‡§Ç ‡§®‡•å‡§ï‡§∞‡§ø‡§Ø‡§æ‡§Å ‡§î‡§∞ ‡§ñ‡§§‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§π‡•à‡§Ç<br><br>

    üëâ <b>‡§∏‡§µ‡§æ‡§≤ ‡§∏‡§ø‡§∞‡•ç‡§´ ‡§á‡§§‡§®‡§æ ‡§π‡•à:</b><br>
    ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™‡§ï‡•Ä ‡§®‡•å‡§ï‡§∞‡•Ä 100% ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§π‡•à?<br>
    ‡§Ö‡§ó‡§∞ ‡§®‡§π‡•Ä‡§Ç‚Ä¶ ‡§§‡•ã ‡§Ü‡§™‡§ï‡•ã ‡§è‡§ï <b>‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§¶‡•Ç‡§∏‡§∞‡§æ income source</b> ‡§ö‡§æ‡§π‡§ø‡§è ‚Äî  
    ‡§µ‡•ã ‡§≠‡•Ä ‡§ê‡§∏‡§æ ‡§ú‡•ã <b>‡§Ü‡§™‡§ï‡•Ä ‡§Æ‡•å‡§ú‡•Ç‡§¶‡§ó‡•Ä ‡§™‡§∞ ‡§®‡§ø‡§∞‡•ç‡§≠‡§∞ ‡§® ‡§π‡•ã‡•§</b>
  </p>

  <h3 style="margin:18px 0 8px;font-size:18px;">
    ‚≠ê RJVC ‚Äî ‡§µ‡•ã System ‡§ú‡§ø‡§∏‡§∏‡•á ‡§Ü‡§™ ‚Äú‡§∏‡•ã‡§§‡•á ‡§π‡•Å‡§è ‡§≠‡•Ä‚Äù ‡§ï‡§Æ‡§æ‡§à ‡§¨‡§®‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§
  </h3>
  <p style="font-size:14px;color:#374151;line-height:1.6;">
    RJVC ‡§Ü‡§™‡§ï‡•á mobile ‡§ï‡•ã ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡§Æ‡§æ‡§à ‡§ï‡§æ <b>auto-earning engine</b> ‡§¨‡§®‡§æ ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§<br><br>
    ‚úî ‡§ï‡•ã‡§à App ‡§®‡§π‡•Ä‡§Ç<br>
    ‚úî ‡§ï‡•ã‡§à target ‡§®‡§π‡•Ä‡§Ç<br>
    ‚úî ‡§ï‡•ã‡§à time limit ‡§®‡§π‡•Ä‡§Ç<br>
    ‚úî ‡§¨‡§∏ ‡§è‡§ï ‡§¨‡§æ‡§∞ ‡§∏‡•á‡§ü ‡§ï‡§∞‡•ã ‚Äî earning ‡§Ö‡§™‡§®‡•á ‡§Ü‡§™ ‡§π‡•ã‡§§‡•Ä ‡§∞‡§π‡§§‡•Ä ‡§π‡•à
  </p>

  <h3 style="margin:18px 0 8px;font-size:18px;">
    üí° ‡§Ö‡§ó‡§∞ ‡§Ü‡§™ ‡§Ö‡§≠‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§ú‡•Å‡§°‡§º‡•á‡§Ç‡§ó‡•á ‡§§‡•ã ‡§®‡•Å‡§ï‡§∏‡§æ‡§® ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?
  </h3>
  <p style="font-size:14px;color:#374151;line-height:1.6;">
    ‡§Ü‡§ú AI ‡§®‡•å‡§ï‡§∞‡§ø‡§Ø‡§æ‡§Å ‡§≤‡•á ‡§∞‡§π‡§æ ‡§π‡•à‚Ä¶  
    ‡§î‡§∞ ‡§ú‡•ã ‡§≤‡•ã‡§ó ‡§¶‡•Ç‡§∏‡§∞‡§æ income source ‡§®‡§π‡•Ä‡§Ç ‡§¨‡§®‡§æ ‡§∞‡§π‡•á  
    <b>2 ‡§∏‡§æ‡§≤ ‡§¨‡§æ‡§¶ ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§∏‡§ø‡§∞‡•ç‡§´ ‡§™‡§õ‡§§‡§æ‡§µ‡§æ ‡§Æ‡§ø‡§≤‡•á‡§ó‡§æ‡•§</b><br><br>
    ‚úî ‡§Ü‡§ú ‡§ú‡•ã ‡§ú‡•Å‡§°‡§º‡•á‡§Ç‡§ó‡•á, ‡§Ü‡§ó‡•á ‡§ï‡§Æ‡§æ‡§è‡§Å‡§ó‡•á<br>
    ‚úî ‡§ú‡•ã ‡§™‡•Ä‡§õ‡•á ‡§∞‡§π‡•á‡§Ç‡§ó‡•á, ‡§∏‡§ø‡§∞‡•ç‡§´ ‡§¶‡•á‡§ñ‡•á‡§Ç‡§ó‡•á
  </p>

  <h3 style="margin:18px 0 8px;font-size:18px;">
    üü¢ RJVC ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§ú‡§º‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à? (Career ‡§ï‡•Ä ‡§≠‡§æ‡§∑‡§æ ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§ù‡§ø‡§è)
  </h3>
  <p style="font-size:14px;color:#374151;line-height:1.6;">
    1Ô∏è‚É£ Job Safe ‡§®‡§π‡•Ä‡§Ç ‚Äî ‡§≤‡•á‡§ï‡§ø‡§® Income Safe ‡§π‡•ã ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à<br>
    2Ô∏è‚É£ Career ‡§¨‡§¶‡§≤‡§®‡•á ‡§ï‡§æ ‡§°‡§∞ Zero<br>
    3Ô∏è‚É£ Slow ‡§®‡§π‡•Ä‡§Ç ‚Äî Smart earning<br>
    4Ô∏è‚É£ Family Income ‡§¨‡§¢‡§º‡§§‡•Ä ‡§π‡•à<br><br>
    ‚≠ê ‡§∏‡§æ‡§• ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡•ã ‚Üí ‡§π‡§∞ ‡§Æ‡§π‡•Ä‡§®‡§æ ‚Çπ30,000+ possible<br>
    ‚≠ê ‡§Ö‡§ï‡•á‡§≤‡•á ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡•ã ‚Üí 5‚Äì6 ‡§Æ‡§π‡•Ä‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‚Çπ5,000+ extra income possible
  </p>

  <h3 style="margin:18px 0 8px;font-size:18px;">
    üèÜ RJVC ‡§ï‡§ø‡§® ‡§≤‡•ã‡§ó‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è perfect ‡§π‡•à?
  </h3>
  <ul style="font-size:14px;color:#374151;line-height:1.7;margin-left:16px;">
    <li>Students ‚Äî Pocket money + skill-free earning</li>
    <li>Housewives ‚Äî ‡§ò‡§∞ ‡§∏‡§Ç‡§≠‡§æ‡§≤‡§§‡•á ‡§π‡•Å‡§è ‡§ï‡§Æ‡§æ‡§à</li>
    <li>Doctors ‚Äî Side income ‡§¨‡§ø‡§®‡§æ time waste</li>
    <li>Engineers ‚Äî Job + additional earning</li>
    <li>Retired Persons ‚Äî Pension ‡§ï‡•á ‡§∏‡§æ‡§• safe income</li>
    <li>Employees ‚Äî ‡§®‡•å‡§ï‡§∞‡•Ä ‡§õ‡•ã‡§°‡§º‡•á ‡§¨‡§ø‡§®‡§æ extra income</li>
    <li>Shop Owners ‚Äî Time ‡§®‡§π‡•Ä‡§Ç ‡§≤‡§ó‡§§‡§æ, ‡§¨‡§∏ system ‡§ö‡§≤‡§§‡§æ ‡§π‡•à</li>
  </ul>

  <h3 style="margin:18px 0 8px;font-size:18px;">
    üí∞ RJVC ‡§ï‡•ã Join ‡§ï‡§∞‡§®‡•á ‡§ï‡•á Strong Benefits
  </h3>
  <ul style="font-size:14px;color:#374151;line-height:1.8;margin-left:16px;">
    <li>Commission Wallet + Bonus Wallet ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó</li>
    <li>Bonus Wallet ‡§π‡§∞ ‡§Æ‡§π‡•Ä‡§®‡•á withdraw ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç</li>
    <li>‡§π‡§∞ ‡§§‡•Ä‡§∏‡§∞‡•á ‡§Æ‡§π‡•Ä‡§®‡•á 1 direct ‚Äî bonus unlock</li>
    <li>Withdrawal ‚Üí admin approval (safe & clean record)</li>
    <li>Earning mobile dashboard ‡§™‡§∞ live ‡§¶‡§ø‡§ñ‡§§‡•Ä ‡§π‡•à</li>
  </ul>
</div>
<!-- LOGIN PAGE -->
<div id="loginPage" class="page">
  <div class="card" style="max-width:480px;">
    <h1>Customer Login</h1>
    <label>Customer Name</label>
    <input id="custName" placeholder="‡§ú‡•à‡§∏‡•á: Rajesh" />
    <div class="mt-2"></div>
    <label>Password</label>
    <input id="custPass" type="password" placeholder="‡§ú‡•à‡§∏‡•á: 1234" />
    <button class="btn btn-primary mt-3" style="width:100%;" id="loginBtn">Login</button>
    <div id="loginMsg" class="error" style="display:none;"></div>
    <p class="small mt-2">
      ‡§Ü‡§™ ‡§á‡§∏ login ‡§∏‡•á ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä customer ‡§ï‡•Ä ID ‡§ñ‡•ã‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§Ö‡§ó‡§∞ ‡§â‡§∏‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§∏‡§π‡•Ä password ‡§™‡§§‡§æ ‡§π‡•ã‡•§
    </p>
  </div>
</div>

<!-- CUSTOMER DASHBOARD -->
<div id="dashboardPage" style="display:none;">
  <div class="page" style="align-items:flex-start;">
    <div class="card">
      <div class="flex between">
        <div>
          <h1 style="font-size:20px;margin-bottom:4px;">Customer Dashboard</h1>
          <div class="small" id="welcomeText"></div>
        </div>
        <button class="btn btn-outline btn-sm" id="logoutBtn">Logout</button>
      </div>

      <!-- 2 Wallets -->
      <div class="wallet wallet-comm mt-3">
        <div class="wallet-label">COMMISSION WALLET</div>
        <div class="wallet-amount" id="commWalletText">‚Çπ0</div>
      </div>

      <div class="wallet wallet-bonus">
        <div class="wallet-label">BONUS WALLET</div>
        <div class="wallet-amount" id="bonusWalletText">‚Çπ0</div>
      </div>

      <!-- BANK DETAILS -->
      <div class="mt-4">
        <div class="section-title">Bank Details (Payment ‡§ï‡•á ‡§≤‡§ø‡§è)</div>
        <p class="small">
          ‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§æ‡§´-‡§∏‡§æ‡§´ ‡§∏‡§π‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§≠‡§∞‡•á‡§Ç‡•§ ‡§Ü‡§™ ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§≠‡•Ä bank ‡§¨‡§¶‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç,
          ‡§≤‡•á‡§ï‡§ø‡§® ‡§™‡•Å‡§∞‡§æ‡§®‡•á withdrawal ‡§ï‡§æ record admin ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§∞‡§π‡•á‡§ó‡§æ‡•§
        </p>

        <div class="wrap-row mt-2">
          <div style="flex:1 1 220px;">
            <label>Account Holder Name</label>
            <input id="bankHolder" />
          </div>
          <div style="flex:1 1 220px;">
            <label>Bank Name</label>
            <input id="bankName" />
          </div>
        </div>

        <div class="wrap-row mt-2">
          <div style="flex:1 1 220px;">
            <label>Account Number</label>
            <input id="bankAccount" />
          </div>
          <div style="flex:1 1 220px;">
            <label>IFSC Code</label>
            <input id="bankIfsc" />
          </div>
        </div>

        <div class="mt-2">
          <label>UPI ID (optional)</label>
          <input id="bankUpi" placeholder="‡§ú‡•à‡§∏‡•á: name@upi" />
        </div>

        <div class="mt-3 flex" style="gap:8px;">
          <button class="btn btn-primary btn-sm" id="saveBankBtn">Save / Update Bank</button>
          <button class="btn btn-outline btn-sm" id="editBankBtn">Edit Enable</button>
        </div>
        <div id="bankMsg" class="ok" style="display:none;"></div>
      </div>

      <!-- WITHDRAWAL REQUEST -->
      <div class="mt-4">
        <div class="section-title">Withdrawal Request</div>
        <p class="small">
          Withdrawal ‡§≤‡§ó‡§æ‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§Ü‡§™‡§ï‡§æ current bank details snapshot Firebase ‡§Æ‡•á‡§Ç save ‡§π‡•ã ‡§ú‡§æ‡§è‡§ó‡§æ‡•§
        </p>

        <div class="wrap-row mt-2">
          <div style="flex:1 1 180px;">
            <label>Amount (‚Çπ)</label>
            <input id="wdAmount" type="number" min="1" />
          </div>
        </div>
        <div class="mt-2">
          <label>Note (optional)</label>
          <textarea id="wdNote" rows="2" placeholder="‡§ï‡•ã‡§à extra info ‡§¶‡•á‡§Ç (optional)"></textarea>
        </div>
        <button class="btn btn-primary mt-3" id="wdRequestBtn">Send Withdrawal Request</button>
        <div id="wdMsg" class="ok" style="display:none;"></div>
      </div>

      <!-- WITHDRAWAL HISTORY -->
      <div class="mt-4">
        <div class="section-title">Withdrawal History</div>
        <div class="small">‡§Ø‡§π ‡§∏‡§ø‡§∞‡•ç‡§´ ‡§Ü‡§™‡§ï‡•Ä ID ‡§ï‡•á withdrawal requests ‡§¶‡§ø‡§ñ‡§æ‡§§‡§æ ‡§π‡•à‡•§</div>
        <div class="mt-2" style="overflow-x:auto;">
          <table>
            <thead>
              <tr>
                <th>Date/Time</th>
                <th>Amount (‚Çπ)</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="wdTableBody">
              <!-- rows via JS -->
            </tbody>
          </table>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- Firebase CDN -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-analytics.js"></script>

<script>
  // ‡§µ‡§π‡•Ä Firebase config (RJVC PLAN)
  const firebaseConfig = {
    apiKey: "AIzaSyBDw_FQyDzWZLJORFtOwZqrFRfeS5tOFSw",
    authDomain: "rjvc-plan.firebaseapp.com",
    projectId: "rjvc-plan",
    storageBucket: "rjvc-plan.firebasestorage.app",
    messagingSenderId: "265431528728",
    appId: "1:265431528728:web:c3dc4b8e8f3ae4469a1a6d",
    measurementId: "G-1Y7PN96H93"
  };

  firebase.initializeApp(firebaseConfig);
  try { firebase.analytics(); } catch(e){}

  const db       = firebase.firestore();
  const usersCol = db.collection("Users");
  const wdCol    = db.collection("Withdrawals");

  const loginPage = document.getElementById("loginPage");
  const dashPage  = document.getElementById("dashboardPage");

  const loginBtn  = document.getElementById("loginBtn");
  const logoutBtn = document.getElementById("logoutBtn");
  const loginMsg  = document.getElementById("loginMsg");

  const welcomeText     = document.getElementById("welcomeText");
  const commWalletText  = document.getElementById("commWalletText");
  const bonusWalletText = document.getElementById("bonusWalletText");

  // bank DOM
  const bankHolder  = document.getElementById("bankHolder");
  const bankName    = document.getElementById("bankName");
  const bankAccount = document.getElementById("bankAccount");
  const bankIfsc    = document.getElementById("bankIfsc");
  const bankUpi     = document.getElementById("bankUpi");
  const bankMsg     = document.getElementById("bankMsg");
  const saveBankBtn = document.getElementById("saveBankBtn");
  const editBankBtn = document.getElementById("editBankBtn");

  // withdrawal DOM
  const wdAmount   = document.getElementById("wdAmount");
  const wdNote     = document.getElementById("wdNote");
  const wdMsg      = document.getElementById("wdMsg");
  const wdRequestBtn = document.getElementById("wdRequestBtn");
  const wdTableBody  = document.getElementById("wdTableBody");

  let currentUserId   = null;
  let currentUserSnap = null;
  let userUnsub       = null;
  let wdUnsub         = null;

  function formatRupees(x){
    return "‚Çπ" + (x || 0);
  }

  function setBankInputsEnabled(flag){
    [bankHolder,bankName,bankAccount,bankIfsc,bankUpi].forEach(inp=>{
      inp.disabled = !flag;
    });
  }

  // LOGIN
  loginBtn.addEventListener("click", async ()=>{
    const name = document.getElementById("custName").value.trim();
    const pass = document.getElementById("custPass").value.trim();
    loginMsg.style.display = "none";

    if(!name || !pass){
      loginMsg.textContent = "‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§≠‡§∞‡•á‡§Ç‡•§";
      loginMsg.style.display = "block";
      return;
    }

    try{
      const snap = await usersCol
        .where("name","==",name)
        .where("password","==",pass)
        .limit(1)
        .get();

      if(snap.empty){
        loginMsg.textContent = "‡§ó‡§≤‡§§ ‡§®‡§æ‡§Æ ‡§Ø‡§æ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°!";
        loginMsg.style.display = "block";
        return;
      }

      const doc = snap.docs[0];
      subscribeCustomer(doc.id);
      subscribeWithdrawals(doc.id);

    }catch(err){
      loginMsg.textContent = "Login error: " + err.message;
      loginMsg.style.display = "block";
    }
  });

  function subscribeCustomer(docId){
    if(userUnsub) userUnsub();
    currentUserId = docId;

    userUnsub = usersCol.doc(docId).onSnapshot(snap=>{
      if(!snap.exists) return;
      currentUserSnap = snap;
      const d = snap.data();

      const name  = d.name || "";
      const comm  = d.commissionWallet || 0;
      const bonus = d.bonusWallet || 0;

      welcomeText.textContent     = "‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à, " + name + " ‡§ú‡•Ä";
      commWalletText.textContent  = formatRupees(comm);
      bonusWalletText.textContent = formatRupees(bonus);

      // bank details fill
      const bank = d.bankDetails || {};
      bankHolder.value  = bank.holderName || "";
      bankName.value    = bank.bankName || "";
      bankAccount.value = bank.accountNumber || "";
      bankIfsc.value    = bank.ifsc || "";
      bankUpi.value     = bank.upi || "";

      bankMsg.style.display = "none";
      setBankInputsEnabled(false); // default read-only

      loginPage.style.display = "none";
      dashPage.style.display  = "block";
    });
  }

  function subscribeWithdrawals(userId){
    if(wdUnsub) wdUnsub();

    wdUnsub = wdCol
      .where("userId","==",userId)
      .orderBy("createdAt","desc")
      .onSnapshot(snap=>{
        wdTableBody.innerHTML = "";
        snap.forEach(doc=>{
          const d = doc.data();
          const tr = document.createElement("tr");
          const ts = d.createdAt ? d.createdAt.toDate().toLocaleString("en-IN") : "-";
          tr.innerHTML = `
            <td>${ts}</td>
            <td>‚Çπ${d.amount || 0}</td>
            <td>${d.status || "pending"}</td>
          `;
          wdTableBody.appendChild(tr);
        });
      });
  }

  // LOGOUT
  logoutBtn.addEventListener("click", ()=>{
    if(userUnsub) userUnsub();
    if(wdUnsub)   wdUnsub();
    userUnsub = null;
    wdUnsub   = null;
    currentUserId   = null;
    currentUserSnap = null;

    document.getElementById("custName").value = "";
    document.getElementById("custPass").value = "";
    dashPage.style.display  = "none";
    loginPage.style.display = "flex";
  });

  // BANK SAVE / UPDATE
  saveBankBtn.addEventListener("click", async ()=>{
    bankMsg.style.display = "none";
    if(!currentUserId){
      bankMsg.textContent = "‡§™‡§π‡§≤‡•á login ‡§ï‡§∞‡•á‡§Ç‡•§";
      bankMsg.className   = "error";
      bankMsg.style.display = "block";
      return;
    }

    const holder  = bankHolder.value.trim();
    const bname   = bankName.value.trim();
    const acc     = bankAccount.value.trim();
    const ifsc    = bankIfsc.value.trim();
    const upi     = bankUpi.value.trim();

    if(!holder || !bname || !acc || !ifsc){
      bankMsg.textContent = "Holder, Bank name, Account number, IFSC ‡§∏‡§¨ ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à‡§Ç‡•§";
      bankMsg.className   = "error";
      bankMsg.style.display = "block";
      return;
    }

    try{
      await usersCol.doc(currentUserId).update({
        bankDetails:{
          holderName: holder,
          bankName: bname,
          accountNumber: acc,
          ifsc: ifsc,
          upi: upi
        }
      });
      bankMsg.textContent = "Bank details save/update ‡§π‡•ã ‡§ó‡§è‡•§";
      bankMsg.className   = "ok";
      bankMsg.style.display = "block";
      setBankInputsEnabled(false);
    }catch(err){
      bankMsg.textContent = "Error: " + err.message;
      bankMsg.className   = "error";
      bankMsg.style.display = "block";
    }
  });

  editBankBtn.addEventListener("click", ()=>{
    setBankInputsEnabled(true);
    bankMsg.style.display = "none";
  });

  // WITHDRAWAL REQUEST
  wdRequestBtn.addEventListener("click", async ()=>{
    wdMsg.style.display = "none";
    if(!currentUserId || !currentUserSnap){
      wdMsg.textContent = "‡§™‡§π‡§≤‡•á login ‡§ï‡§∞‡•á‡§Ç‡•§";
      wdMsg.className   = "error";
      wdMsg.style.display = "block";
      return;
    }

    const amount = Number(wdAmount.value || 0);
    const note   = wdNote.value.trim();

    if(!amount || amount <= 0){
      wdMsg.textContent = "Amount (‚Çπ) ‡§∏‡§π‡•Ä ‡§≠‡§∞‡•á‡§Ç‡•§";
      wdMsg.className   = "error";
      wdMsg.style.display = "block";
      return;
    }

    const d = currentUserSnap.data();
    const totalBalance = (d.commissionWallet || 0) + (d.bonusWallet || 0);
    if(amount > totalBalance){
      wdMsg.textContent = "‡§Ü‡§™‡§ï‡•á total balance ‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ amount ‡§®‡§π‡•Ä‡§Ç ‡§≤‡•á ‡§∏‡§ï‡§§‡•á‡•§";
      wdMsg.className   = "error";
      wdMsg.style.display = "block";
      return;
    }

    const bank = d.bankDetails || {};
    if(!bank.holderName || !bank.bankName || !bank.accountNumber || !bank.ifsc){
      wdMsg.textContent = "Withdrawal ‡§∏‡•á ‡§™‡§π‡§≤‡•á bank details ‡§™‡•Ç‡§∞‡§æ ‡§≠‡§∞‡•á‡§Ç‡•§";
      wdMsg.className   = "error";
      wdMsg.style.display = "block";
      return;
    }

    try{
      await wdCol.add({
        userId: currentUserId,
        userName: d.name || "",
        amount: amount,
        status: "pending",
        note: note,
        bankSnapshot: bank, // ‡§â‡§∏ ‡§ü‡§æ‡§á‡§Æ ‡§ï‡•á bank details
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      });

      wdMsg.textContent = "Withdrawal request ‡§≠‡•á‡§ú ‡§¶‡•Ä ‡§ó‡§à (status: pending).";
      wdMsg.className   = "ok";
      wdMsg.style.display = "block";
      wdAmount.value = "";
      wdNote.value   = "";
    }catch(err){
      wdMsg.textContent = "Error: " + err.message;
      wdMsg.className   = "error";
      wdMsg.style.display = "block";
    }
  });
</script>

</body>
</html>
