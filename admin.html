<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8" />
<title>RJVC Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
  body {
    margin:0;
    padding:20px;
    background:#f1f3ff;
    font-family:system-ui;
  }
  .box {
    max-width:900px;
    margin:auto;
    background:white;
    padding:20px;
    border-radius:16px;
    box-shadow:0 10px 25px rgba(0,0,0,0.15);
  }
  h1 {
    text-align:center;
    color:#001f5c;
  }
  h2 {
    color:#031b4f;
    border-left:4px solid #4a6eff;
    padding-left:8px;
  }
  label {
    font-weight:600;
  }
  input {
    width:100%;
    padding:8px;
    border-radius:8px;
    border:1px solid #bbb;
    margin-top:4px;
  }
  button {
    background:#002fad;
    color:white;
    padding:10px 18px;
    border:none;
    border-radius:10px;
    margin-top:10px;
    cursor:pointer;
  }
  table {
    width:100%;
    border-collapse:collapse;
    margin-top:15px;
  }
  th, td {
    padding:8px;
    border-bottom:1px solid #ddd;
    font-size:14px;
  }
  th {
    background:#eaf0ff;
  }
  .approve-btn {
    background:#008f2a;
    color:white;
    padding:5px 12px;
    border:none;
    border-radius:6px;
    cursor:pointer;
  }
  .reject-btn {
    background:#ff3131;
    color:white;
    padding:5px 12px;
    border:none;
    border-radius:6px;
    cursor:pointer;
  }
</style>
</head>

<body>
<div class="box">

  <h1>RJVC ADMIN PANEL</h1>

  <!-- CREATE CUSTOMER SECTION -->
  <h2>नया Customer Create करें</h2>

  <label>Customer Name</label>
  <input id="custName" type="text" placeholder="जैसे: रमेश" />

  <label style="margin-top:10px;">Mobile Number</label>
  <input id="custMobile" type="tel" placeholder="10 digit number" />

  <button onclick="createCustomer()">Create Customer</button>

  <div id="createMsg" style="margin-top:10px; color:green; font-weight:600;"></div>


  <!-- CUSTOMER LIST -->
  <h2 style="margin-top:25px;">Customer List</h2>
  <table id="customerTable">
    <thead>
      <tr>
        <th>Name</th>
        <th>Mobile</th>
        <th>Commission Wallet</th>
        <th>Bonus Wallet</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>


  <!-- WITHDRAW REQUEST LIST -->
  <h2 style="margin-top:30px;">Withdrawal Requests (Approve / Reject)</h2>

  <table id="withdrawTable">
    <thead>
      <tr>
        <th>Name</th>
        <th>Mobile</th>
        <th>Amount</th>
        <th>Wallet</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

</div>

<script>
function getCustomers() {
  return JSON.parse(localStorage.getItem("rjvc_customers") || "[]");
}
function saveCustomers(arr) {
  localStorage.setItem("rjvc_customers", JSON.stringify(arr));
}

function getWithdrawals() {
  return JSON.parse(localStorage.getItem("rjvc_withdrawals") || "[]");
}
function saveWithdrawals(arr) {
  localStorage.setItem("rjvc_withdrawals", JSON.stringify(arr));
}

/* -------------------- CREATE CUSTOMER -------------------- */
function createCustomer() {
  let name = document.getElementById("custName").value.trim();
  let mobile = document.getElementById("custMobile").value.trim();

  if (!name || !mobile) {
    alert("Name और Mobile दोनों जरूरी हैं।");
    return;
  }
  if (mobile.length < 10) {
    alert("Valid mobile number डालें।");
    return;
  }

  let customers = getCustomers();
  if (customers.some(c => c.mobile === mobile)) {
    alert("यह mobile पहले से registered है।");
    return;
  }

  customers.push({
    id: Date.now(),
    name,
    mobile,
    joinedMembers: 0,
    state: "new",
    currentLevel: 0,
    totalIncome: 0,
    walletBalance: 0,
    bonusBalance: 0,
    createdAt: new Date().toISOString()
  });

  saveCustomers(customers);

  document.getElementById("createMsg").innerText =
    "Customer सफलतापूर्वक बनाया गया ✔️";

  loadCustomers();

  document.getElementById("custName").value = "";
  document.getElementById("custMobile").value = "";
}

/* -------------------- SHOW CUSTOMER LIST -------------------- */
function loadCustomers() {
  let customers = getCustomers();
  let tbody = document.querySelector("#customerTable tbody");
  tbody.innerHTML = "";

  customers.forEach(c => {
    let tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${c.name}</td>
      <td>${c.mobile}</td>
      <td>₹${c.walletBalance || 0}</td>
      <td>₹${c.bonusBalance || 0}</td>
    `;
    tbody.appendChild(tr);
  });
}

/* -------------------- WITHDRAW LIST -------------------- */
function loadWithdrawals() {
  let list = getWithdrawals();
  let tbody = document.querySelector("#withdrawTable tbody");
  tbody.innerHTML = "";

  list
    .filter(w => w.status === "Pending")
    .forEach(w => {
      let tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${w.name}</td>
        <td>${w.mobile}</td>
        <td>₹${w.amount}</td>
        <td>${w.source === "bonus" ? "Bonus Wallet" : "Commission Wallet"}</td>
        <td>
          <button class="approve-btn" onclick="approveWithdraw(${w.id})">Approve</button>
          <button class="reject-btn" onclick="rejectWithdraw(${w.id})">Reject</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
}

/* -------------------- APPROVE / REJECT -------------------- */
function approveWithdraw(id) {
  let list = getWithdrawals();
  let item = list.find(w => w.id === id);
  if (!item) return;

  item.status = "Paid";
  saveWithdrawals(list);
  loadWithdrawals();
  alert("Withdrawal Approved ✔️");
}

function rejectWithdraw(id) {
  let list = getWithdrawals();
  let item = list.find(w => w.id === id);
  if (!item) return;

  item.status = "Rejected";
  saveWithdrawals(list);
  loadWithdrawals();
  alert("Withdrawal Rejected ❌");
}

/* -------------------- INIT -------------------- */
loadCustomers();
loadWithdrawals();
</script>

</body>
</html>
